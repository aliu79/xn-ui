(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22c6c6"],{f2bf:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"content element-doc"},[t._m(0),t._m(1),n("demo-block",[n("template",{slot:"source"},[n("element-demo0")],1),n("template",{slot:"highlight"},[n("pre",{pre:!0},[n("code",{pre:!0,attrs:{class:"html"}},[t._v('<template>\n  <div>\n        <el-form :model="form">\n            <el-form-item label="签约金额" prop="">\n                <el-link type="success" :underline="false" icon="el-icon-circle-plus-outline" @click="handleAdd(\'signingAmounts\')">添加明细</el-link>\n                <xn-table :data="form.signingAmounts" border :index="false">\n                    <el-table-column label="金额（未税）" prop="">\n                    <template slot-scope="{ row }">\n                        <el-input v-model="row.priceExcludingTax" placeholder="金额（未税）" size="mini" clearable @input="computed(row,\'priceExcludingTax\')" />\n                    </template>\n                    </el-table-column>\n                    <el-table-column label="税率" prop="">\n                    <template slot-scope="{ row }">\n                        <el-input v-model.number="row.taxRate" min="0" max="100" type="number" placeholder="税率" size="mini" clearable @input="computed(row,\'taxRate\')" />\n                    </template>\n                    </el-table-column>\n                    <el-table-column label="金额（含税）" prop="">\n                    <template slot-scope="{ row }">\n                        <el-input v-model="row.totalPrice" placeholder="金额（含税）" size="mini" clearable @input="computed(row,\'totalPrice\')" />\n                    </template>\n                    </el-table-column>\n                    <el-table-column label="税额" prop="">\n                    <template slot-scope="{ row }">\n                        <span>{{row.taxAmount}}</span>\n                    </template>\n                    </el-table-column>\n                    <el-table-column label="操作" prop="" width="70px">\n                    <template slot-scope="{ row, $index }">\n                        <el-button type="text" @click="handleRemove(row,$index,\'signingAmounts\')">删除</el-button>\n                    </template>\n                    </el-table-column>\n                </xn-table>\n                </el-form-item>\n        </el-form>\n\n        <p class="text-warning">最终计算结果：{{result}}</p>\n        \n        <p class="mt-30">需要计算的字段：{{fields}} （按照表单顺序）</p>\n        <p>最终需要计算的：{{fields[0]}}</p>\n\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      form: {\n        signingAmounts: []\n      },\n      tpl: {\n        signingAmounts: {\n          priceExcludingTax: \'\',\n          taxRate: \'\',\n          taxAmount: \'\',\n          totalPrice: \'\'\n        }\n      },\n      rules: {},\n      fields: [\'priceExcludingTax\', \'taxRate\', \'totalPrice\',\'taxAmount\'],\n      fieldsRules: {\n        priceExcludingTax:(row)=> {\n            if(row.totalPrice&&row.taxRate){\n                row.priceExcludingTax = this.$math.div(row.totalPrice,row.taxRate/100)\n                row.taxAmount = this.$math.sub(row.priceExcludingTax,row.totalPrice)\n            }\n        },\n        taxRate:(row)=> {\n            // console.log(\'row: \', row);\n        },\n        taxAmount:(row)=> {\n            if(row.totalPrice&&row.priceExcludingTax){\n                row.taxAmount = this.$math.sub(row.priceExcludingTax,row.totalPrice)\n            }\n        },\n        totalPrice:(row)=> {\n            if(row.taxRate&&row.priceExcludingTax){\n                row.totalPrice = this.$math.sub(row.priceExcludingTax,this.$math.mul(row.priceExcludingTax,row.taxRate/100))\n                row.taxAmount = this.$math.sub(row.priceExcludingTax,row.totalPrice)\n            }\n        }\n      },\n      result:{\n        priceExcludingTax: \'\',\n        taxRate: \'\',\n        taxAmount: \'\',\n        totalPrice: \'\'\n      }\n    }\n  },\n  methods: {\n    computed(value, field) {\n        const res = this.$math.autoComputed(this.fields,this.fieldsRules,field,value)\n        // 计算总未税\n        this.result.priceExcludingTax = this.$math.add(this.form.signingAmounts,\'priceExcludingTax\')\n        // 计算总税率\n        this.result.taxRate = this.$math.add(this.form.signingAmounts,\'taxRate\')\n        // 计算总含税\n        this.result.totalPrice = this.$math.add(this.form.signingAmounts,\'totalPrice\')\n        // 计算总税额\n        this.result.taxAmount = this.$math.add(this.form.signingAmounts,\'taxAmount\')\n    },\n    handleAdd(type) {\n      switch (type) {\n        case \'signingAmounts\':\n          this.form.signingAmounts.push(this.$lodash.cloneDeep(this.tpl[type]))\n          break\n      }\n    },\n    handleRemove(_, idx, type) {\n      this.form[type].forEach((item, index, arr) => {\n        if (idx === index) {\n          arr.splice(idx, 1)\n        }\n      })\n    }\n  }\n}\n<\/script>\n')])])])],2)],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h2",{attrs:{id:"shu-ru-ren-yi-kuang-ji-suan-zui-zhong-zhi"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shu-ru-ren-yi-kuang-ji-suan-zui-zhong-zhi"}},[t._v("¶")]),t._v(" 输入任意框计算最终值")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("因业务需求中要求"),n("code",[t._v("3个输入框，输入任意2个值计算第3个值")]),t._v("，想到了以下计算方式作为参考，优势在于减少了每种条件下的"),n("code",[t._v("if")]),t._v("，只需要写入需要计算的值的公式。")])}],l={name:"component-doc",components:{"element-demo0":function(){var t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[[n("div",[n("el-form",{attrs:{model:t.form}},[n("el-form-item",{attrs:{label:"签约金额",prop:""}},[n("el-link",{attrs:{type:"success",underline:!1,icon:"el-icon-circle-plus-outline"},on:{click:function(e){return t.handleAdd("signingAmounts")}}},[t._v("添加明细")]),t._v(" "),n("xn-table",{attrs:{data:t.form.signingAmounts,border:"",index:!1}},[n("el-table-column",{attrs:{label:"金额（未税）",prop:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-input",{attrs:{placeholder:"金额（未税）",size:"mini",clearable:""},on:{input:function(e){return t.computed(a,"priceExcludingTax")}},model:{value:a.priceExcludingTax,callback:function(e){t.$set(a,"priceExcludingTax",e)},expression:"row.priceExcludingTax"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"税率",prop:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-input",{attrs:{min:"0",max:"100",type:"number",placeholder:"税率",size:"mini",clearable:""},on:{input:function(e){return t.computed(a,"taxRate")}},model:{value:a.taxRate,callback:function(e){t.$set(a,"taxRate",t._n(e))},expression:"row.taxRate"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"金额（含税）",prop:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-input",{attrs:{placeholder:"金额（含税）",size:"mini",clearable:""},on:{input:function(e){return t.computed(a,"totalPrice")}},model:{value:a.totalPrice,callback:function(e){t.$set(a,"totalPrice",e)},expression:"row.totalPrice"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"税额",prop:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s(a.taxAmount))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",prop:"",width:"70px"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row,i=e.$index;return[n("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleRemove(a,i,"signingAmounts")}}},[t._v("删除")])]}}])})],1)],1)],1),t._v(" "),n("p",{staticClass:"text-warning"},[t._v("最终计算结果："+t._s(t.result))]),t._v(" "),n("p",{staticClass:"mt-30"},[t._v("需要计算的字段："+t._s(t.fields)+" （按照表单顺序）")]),t._v(" "),n("p",[t._v("最终需要计算的："+t._s(t.fields[0]))])],1)]],2)},e=[];const n={data(){return{form:{signingAmounts:[]},tpl:{signingAmounts:{priceExcludingTax:"",taxRate:"",taxAmount:"",totalPrice:""}},rules:{},fields:["priceExcludingTax","taxRate","totalPrice","taxAmount"],fieldsRules:{priceExcludingTax:t=>{t.totalPrice&&t.taxRate&&(t.priceExcludingTax=this.$math.div(t.totalPrice,t.taxRate/100),t.taxAmount=this.$math.sub(t.priceExcludingTax,t.totalPrice))},taxRate:t=>{},taxAmount:t=>{t.totalPrice&&t.priceExcludingTax&&(t.taxAmount=this.$math.sub(t.priceExcludingTax,t.totalPrice))},totalPrice:t=>{t.taxRate&&t.priceExcludingTax&&(t.totalPrice=this.$math.sub(t.priceExcludingTax,this.$math.mul(t.priceExcludingTax,t.taxRate/100)),t.taxAmount=this.$math.sub(t.priceExcludingTax,t.totalPrice))}},result:{priceExcludingTax:"",taxRate:"",taxAmount:"",totalPrice:""}}},methods:{computed(t,e){this.$math.autoComputed(this.fields,this.fieldsRules,e,t);this.result.priceExcludingTax=this.$math.add(this.form.signingAmounts,"priceExcludingTax"),this.result.taxRate=this.$math.add(this.form.signingAmounts,"taxRate"),this.result.totalPrice=this.$math.add(this.form.signingAmounts,"totalPrice"),this.result.taxAmount=this.$math.add(this.form.signingAmounts,"taxAmount")},handleAdd(t){switch(t){case"signingAmounts":this.form.signingAmounts.push(this.$lodash.cloneDeep(this.tpl[t]));break}},handleRemove(t,e,n){this.form[n].forEach((t,n,a)=>{e===n&&a.splice(e,1)})}}};return{render:t,staticRenderFns:e,...n}}()}},o=l,r=n("0c7c"),s=Object(r["a"])(o,a,i,!1,null,null,null);e["default"]=s.exports}}]);